function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"0rIZ":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("vkgz"),r=n("fXoL"),o=n("nm5K"),s=function(){var e=function(){function e(t){_classCallCheck(this,e),this.apiService=t}return _createClass(e,[{key:"getClients",value:function(){var e=this;return this.apiService.getReq("clients/").pipe(Object(a.a)((function(t){t.status&&(e.clients=t.data)})))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(r.Zb(o.a))},e.\u0275prov=r.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},"5aeq":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n("vkgz"),r=n("fXoL"),o=n("nm5K"),s=n("IYfF"),i=function(){var e=function(){function e(t,n){_classCallCheck(this,e),this.apiService=t,this.authService=n}return _createClass(e,[{key:"getProjects",value:function(){var e=this;return this.apiService.getReq("projects/").pipe(Object(a.a)((function(t){t.status&&(e.projects=t.data)})))}},{key:"findProject",value:function(e){return this.projects.find((function(t){return t.id===Number(e)}))}},{key:"editableProject",set:function(e){this._editableProject=e},get:function(){return this._editableProject}},{key:"projects",set:function(e){this._projects=e},get:function(){return this._projects}}]),e}();return e.\u0275fac=function(t){return new(t||e)(r.Zb(o.a),r.Zb(s.a))},e.\u0275prov=r.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},"PTt/":function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var a=n("fXoL"),r=n("3Pt+"),o=n("nm5K"),s=n("mAmA"),i=n("ofXK");function c(e,t){1&e&&a.Nb(0,"i",22)}function l(e,t){1&e&&a.Nb(0,"i",23)}function u(e,t){if(1&e){var n=a.Sb();a.Rb(0,"div",15),a.Rb(1,"div"),a.Nb(2,"i",16),a.Hc(3," \u0627\u0644\u0645\u0644\u062e\u0635 \u0627\u0644\u0639\u0627\u0645 "),a.Qb(),a.Rb(4,"div"),a.Rb(5,"button",17),a.Fc(6,c,1,0,"i",18),a.Fc(7,l,1,0,"i",19),a.Qb(),a.Rb(8,"button",20),a.dc("click",(function(){a.yc(n);var e=a.hc();return e.addGeneralSummary({steps_explain:null,consultant_general_summary:null,company_general_summary:null}),e.deleteGeneralSummary.emit({show:!1,type:e.type})})),a.Nb(9,"i",21),a.Qb(),a.Qb(),a.Qb()}if(2&e){var r=a.hc();a.zb(5),a.oc("disabled",r.showLoader),a.zb(1),a.oc("ngIf",!r.showLoader),a.zb(1),a.oc("ngIf",r.showLoader)}}function m(e,t){1&e&&a.Nb(0,"i",22)}function p(e,t){1&e&&a.Nb(0,"i",23)}function f(e,t){if(1&e){var n=a.Sb();a.Rb(0,"div",24),a.Rb(1,"button",17),a.Fc(2,m,1,0,"i",18),a.Fc(3,p,1,0,"i",19),a.Qb(),a.Rb(4,"button",20),a.dc("click",(function(){return a.yc(n),a.hc().addReport({steps_explain:null,consultant_general_summary:null,company_general_summary:null})})),a.Nb(5,"i",21),a.Qb(),a.Qb()}if(2&e){var r=a.hc();a.zb(1),a.oc("disabled",r.showLoader),a.zb(1),a.oc("ngIf",!r.showLoader),a.zb(1),a.oc("ngIf",r.showLoader)}}function d(e,t){1&e&&(a.Rb(0,"div",25),a.Hc(1," pdf file "),a.Qb())}function g(e,t){1&e&&(a.Rb(0,"div",25),a.Hc(1," pdf file "),a.Qb())}function h(e,t){if(1&e){var n=a.Sb();a.Rb(0,"div",32),a.Rb(1,"span",33),a.dc("click",(function(){a.yc(n);var e=t.$implicit,r=t.index;return a.hc(2).delteImg(e.id,r)})),a.Nb(2,"i",34),a.Qb(),a.Nb(3,"img",35),a.Qb()}if(2&e){var r=t.$implicit;a.zb(3),a.oc("src",r.image,a.Ac)}}function b(e,t){if(1&e){var n=a.Sb();a.Rb(0,"div",26),a.Rb(1,"label",6),a.Hc(2," \u0635\u0648\u0631 \u0627\u0644\u0645\u0634\u0631\u0648\u0639 "),a.Qb(),a.Rb(3,"div",27),a.Rb(4,"a",28),a.Nb(5,"i",29),a.Rb(6,"input",30),a.dc("change",(function(e){return a.yc(n),a.hc().onuploadImage(e)})),a.Qb(),a.Qb(),a.Fc(7,h,4,1,"div",31),a.Qb(),a.Qb()}if(2&e){var r=a.hc();a.zb(7),a.oc("ngForOf",r.projectImgs)}}var _=function(){var e=function(){function e(t,n,r){_classCallCheck(this,e),this.formBuilder=t,this.apiService=n,this.toaster=r,this.reportPage=!1,this.deleteGeneralSummary=new a.n,this.formData=new FormData,this.showLoader=!1,this.projectImgs=[],this.pageType="add",this.imgCounter=1,this.formSubmitted=!1}return _createClass(e,[{key:"ngOnInit",value:function(){this.createForm(),this.data&&(this.generalSummaryForm.patchValue({steps_explain:this.data.steps_explain,consultant_general_summary:this.data.consultant_general_summary,company_general_summary:this.data.company_general_summary}),this.data.report_images&&(this.projectImgs=this.data.report_images,this.imgCounter=this.projectImgs.length+1),this.pageType="edit")}},{key:"createForm",value:function(){this.generalSummaryForm=this.formBuilder.group({steps_explain:[null,[r.q.required]],company_general_summary:[null],consultant_general_summary:[null]})}},{key:"addGeneralSummary",value:function(e){var t=this;if(this.formSubmitted=!0,this.generalSummaryForm.valid){this.showLoader=!0,this.formData.append("steps_explain",e.steps_explain);var n=this.formData;null===e.steps_explain&&null===e.consultant_general_summary&&null===e.company_general_summary&&(n=e),this.apiService.patchReq("main-stages/".concat(this.mainStageId,"/"),n).subscribe((function(n){n.status?null===e.steps_explain&&null===e.consultant_general_summary&&null===e.company_general_summary?(t.toaster.showSuccess("\u062a\u0645\u062a \u0645\u0633\u062d \u0627\u0644\u0645\u0644\u062e\u0635 \u0627\u0644\u0639\u0627\u0645 "),t.generalSummaryForm.reset()):t.toaster.showSuccess("\u062a\u0645\u062a \u0627\u0636\u0627\u0641\u0629 \u0627\u0644\u0645\u0644\u062e\u0635 \u0627\u0644\u0639\u0627\u0645 \u0628\u0646\u062c\u0627\u062d"):t.toaster.showError(n.errors.length?n.errors[0].split(":")[1]:n.message),t.showLoader=!1}),(function(e){t.toaster.showError(),t.showLoader=!1}))}}},{key:"uploadReport",value:function(e,t){var n=e.target.files[0];switch(t){case"company_general_summary":this.formData.append("company_general_summary",n,n.name),this.generalSummaryForm.get("company_general_summary").setValue(n);break;case"consultant_general_summary":this.formData.append("consultant_general_summary",n,n.name),this.generalSummaryForm.get("consultant_general_summary").setValue(n)}}},{key:"addReport",value:function(e){var t=this;if(this.formSubmitted=!0,this.generalSummaryForm.valid){this.showLoader=!0,this.formData.append("steps_explain",e.steps_explain),this.formData.append("project",String(this.projectId)),this.formData.append("stage_type",String(this.stageType)),this.formData.append("is_report",String(!0));var n=this.formData;null===e.steps_explain&&null===e.consultant_general_summary&&null===e.company_general_summary&&((n=e).project=this.projectId,n.stage_type=this.stageType,n.is_report=!0),"add"===this.pageType?this.apiService.postReq("main-stages/",n).subscribe((function(n){n.status?null===e.steps_explain&&null===e.consultant_general_summary&&null===e.company_general_summary?(t.toaster.showSuccess("\u062a\u0645\u062a \u0645\u0633\u062d \u0627\u0644\u0645\u0644\u062e\u0635 \u0627\u0644\u0639\u0627\u0645 "),t.generalSummaryForm.reset()):t.toaster.showSuccess("\u062a\u0645\u062a \u0627\u0636\u0627\u0641\u0629 \u0627\u0644\u0645\u0644\u062e\u0635 \u0627\u0644\u0639\u0627\u0645 \u0628\u0646\u062c\u0627\u062d"):t.toaster.showError(n.errors.length?n.errors[0].split(":")[1]:n.message),t.showLoader=!1}),(function(e){t.toaster.showError(),t.showLoader=!1})):this.apiService.patchReq("main-stages/".concat(this.mainStageId,"/?is_report=true"),n).subscribe((function(n){n.status?null===e.steps_explain&&null===e.consultant_general_summary&&null===e.company_general_summary?(t.toaster.showSuccess("\u062a\u0645\u062a \u0645\u0633\u062d \u0627\u0644\u0645\u0644\u062e\u0635 \u0627\u0644\u0639\u0627\u0645 "),t.generalSummaryForm.reset()):t.toaster.showSuccess("\u062a\u0645\u062a \u062a\u062d\u062f\u064a\u062b \u0627\u0644\u0645\u0644\u062e\u0635 \u0627\u0644\u0639\u0627\u0645 \u0628\u0646\u062c\u0627\u062d"):t.toaster.showError(n.errors.length?n.errors[0].split(":")[1]:n.message),t.showLoader=!1}),(function(e){t.toaster.showError(),t.showLoader=!1}))}}},{key:"onuploadImage",value:function(e){var t=this,n=e.target.files[0];this.formData.append("image_"+this.imgCounter,n,n.name),this.imgCounter++;var a=new FileReader;a.onload=function(e){t.projectImgs.push({image:e.target.result})},a.readAsDataURL(e.target.files[0])}},{key:"delteImg",value:function(e,t){var n=this;e?this.apiService.deleteReq("report-images/".concat(e,"/")).subscribe((function(e){e.status?(n.toaster.showSuccess("\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u0635\u0648\u0631\u0647"),n.projectImgs.splice(t,1),n.formData.delete("image_"+t+1)):n.toaster.showError(e.errors.length?e.errors[0].split(":")[1]:e.message)}),(function(e){n.toaster.showError()})):(this.projectImgs.splice(t,1),this.formData.delete("image_"+t+1))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(a.Mb(r.c),a.Mb(o.a),a.Mb(s.a))},e.\u0275cmp=a.Gb({type:e,selectors:[["general-summary"]],inputs:{projectId:"projectId",reportPage:"reportPage",type:"type",data:"data",mainStageId:"mainStageId",stageType:"stageType"},outputs:{deleteGeneralSummary:"deleteGeneralSummary"},decls:29,vars:8,consts:[[1,"form",3,"formGroup","ngSubmit"],["class","d-flex justify-content-between btns head",4,"ngIf"],["class","d-flex justify-content-end btns",4,"ngIf"],[1,"row"],[1,"col-12"],[1,"form-group"],[1,"control-label"],[1,"annotation-required"],["rows","4","formControlName","steps_explain",1,"form-control"],[1,"col-md-6"],[1,"file"],["type","file","accept","application/pdf",1,"form-control",3,"change"],["class","report-name",4,"ngIf"],[1,"fas","fa-paperclip"],["class","imgs",4,"ngIf"],[1,"d-flex","justify-content-between","btns","head"],[1,"fas","fa-file-alt"],["type","submit",1,"save",3,"disabled"],["class","fas fa-check",4,"ngIf"],["class","fas fa-spinner",4,"ngIf"],["type","button",1,"delete",3,"click"],[1,"fas","fa-trash-alt"],[1,"fas","fa-check"],[1,"fas","fa-spinner"],[1,"d-flex","justify-content-end","btns"],[1,"report-name"],[1,"imgs"],[1,"d-flex"],[1,"img-upload","my-1"],[1,"fas","fa-plus-circle"],["type","file",3,"change"],["class","m-1 img-holder",4,"ngFor","ngForOf"],[1,"m-1","img-holder"],[3,"click"],[1,"fas","fa-times"],["width","100","height","100",1,"",3,"src"]],template:function(e,t){1&e&&(a.Rb(0,"form",0),a.dc("ngSubmit",(function(){return t.reportPage?t.addReport(t.generalSummaryForm.value):t.addGeneralSummary(t.generalSummaryForm.value)})),a.Fc(1,u,10,3,"div",1),a.Fc(2,f,6,3,"div",2),a.Rb(3,"div",3),a.Rb(4,"div",4),a.Rb(5,"div",5),a.Rb(6,"label",6),a.Hc(7," \u0634\u0631\u062d \u0627\u0644\u062e\u0637\u0648\u0627\u062a "),a.Rb(8,"span",7),a.Hc(9,"*"),a.Qb(),a.Qb(),a.Nb(10,"textarea",8),a.Qb(),a.Qb(),a.Qb(),a.Rb(11,"div",3),a.Rb(12,"div",9),a.Rb(13,"div",5),a.Rb(14,"label",6),a.Hc(15," \u0627\u0644\u0645\u0644\u062e\u0635 \u0627\u0644\u0639\u0627\u0645 \u0644\u0644\u0634\u0631\u0643\u0629 "),a.Qb(),a.Rb(16,"div",10),a.Rb(17,"input",11),a.dc("change",(function(e){return t.uploadReport(e,"company_general_summary")})),a.Qb(),a.Fc(18,d,2,0,"div",12),a.Qb(),a.Nb(19,"i",13),a.Qb(),a.Qb(),a.Rb(20,"div",9),a.Rb(21,"div",5),a.Rb(22,"label",6),a.Hc(23," \u0627\u0644\u0645\u0644\u062e\u0635 \u0627\u0644\u0639\u0627\u0645 \u0644\u0644\u0627\u0633\u062a\u0634\u0627\u0631\u064a "),a.Qb(),a.Rb(24,"div",10),a.Rb(25,"input",11),a.dc("change",(function(e){return t.uploadReport(e,"consultant_general_summary")})),a.Qb(),a.Fc(26,g,2,0,"div",12),a.Qb(),a.Nb(27,"i",13),a.Qb(),a.Qb(),a.Qb(),a.Fc(28,b,8,1,"div",14),a.Qb()),2&e&&(a.oc("formGroup",t.generalSummaryForm),a.zb(1),a.oc("ngIf",!t.reportPage),a.zb(1),a.oc("ngIf",t.reportPage),a.zb(8),a.Eb("err",t.formSubmitted&&t.generalSummaryForm.get("steps_explain").invalid),a.zb(8),a.oc("ngIf",t.generalSummaryForm.get("company_general_summary").value),a.zb(8),a.oc("ngIf",t.generalSummaryForm.get("consultant_general_summary").value),a.zb(2),a.oc("ngIf",t.reportPage))},directives:[r.s,r.k,r.e,i.l,r.b,r.j,r.d,i.k],styles:[".d-flex.head[_ngcontent-%COMP%]{background-color:#186076;color:#fff;padding:5px}.d-flex.head[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#fff}.d-flex[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:transparent;margin-right:5px;border:none;cursor:pointer}.d-flex[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:last-child{color:#bc4747}.imgs[_ngcontent-%COMP%]   .d-flex[_ngcontent-%COMP%]{flex-wrap:wrap}.imgs[_ngcontent-%COMP%]   .img-holder[_ngcontent-%COMP%]{position:relative;width:100px;height:100px}.imgs[_ngcontent-%COMP%]   .img-holder[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;left:0;top:0;background-color:#186076;width:20px;height:20px;line-height:20px;text-align:center;color:#fff}"]}),e}()},Pd9Q:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("fXoL"),r=function(){var e=function(){function e(t){_classCallCheck(this,e),this._el=t}return _createClass(e,[{key:"onInputChange",value:function(e){var t=this._el.nativeElement.value;this._el.nativeElement.value=t.replace(/[\u0621-\u064A ]+$/g,""),t!==this._el.nativeElement.value&&e.stopPropagation()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(a.Mb(a.l))},e.\u0275dir=a.Hb({type:e,selectors:[["","numbersOnly",""]],hostBindings:function(e,t){1&e&&a.dc("input",(function(e){return t.onInputChange(e)}))}}),e}()},yByJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("fXoL"),r=n("tyNb"),o=function(){var e=function e(t){_classCallCheck(this,e),this.router=t,this.showSideBar=!1};return e.\u0275fac=function(t){return new(t||e)(a.Zb(r.b))},e.\u0275prov=a.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()}}]);